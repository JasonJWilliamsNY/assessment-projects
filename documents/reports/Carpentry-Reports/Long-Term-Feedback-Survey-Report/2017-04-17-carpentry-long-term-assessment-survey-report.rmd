# Analysis of the Carpentry's Long-Term Feedback Survey
__Author__: [Kari L. Jordan](https://github.com/kariljordan)
__Published__: April 2017

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

Data and Software Carpentry launched a [long-term assessment survey](https://www.surveymonkey.com/r/carpentrieslongtermassessment) in March 2017. The goal of this survey is to hear from our respondents about what has transpired in their work and career since completing a Carpentry workshop. Read our about our long-term assessment strategy on our [blog](http://www.datacarpentry.org/blog/long-term-assessment-strategy/) and see how the community was involved with the development of this survey.

A [PDF](https://github.com/carpentries/public-survey-info/blob/master/documents/surveys/2017-04-17-carpentry-long-term-feedback-survey.pdf) of the survey questions, the data used in this analysis, and the .RMD file are located in the [long-term feedback survey report](https://github.com/carpentries/public-survey-info/tree/master/documents/reports/Carpentry-Reports/Long-Term-Feedback-Survey-Report) folder on GitHub. Feel free to use the data and [tell us](mailto: kariljordan@carpentries.org) about your findings.

As of April 20, 2017, 510 learners have responded to the survey. Not all respondents answered each of the 26 questions.

```{r include=FALSE}
# install.packages("ggmap", type = "source")
# install.packages("likert")
# install.packages("purrr")
# install.packages("mapproj")
# install.packages("ggplot2")
# install.packages("dplyr")
# install.packages("knitr")
# install.packages("RColorBrewer")
library(ggmap)
library(likert)
library(purrr)
library(mapproj)
library(ggplot2)
library(dplyr)
library(knitr)
library(RColorBrewer)
display.brewer.all()
update.packages(repos = "https://cloud.r-project.org")
```
```{r purl=TRUE}
download.file("https://raw.githubusercontent.com/carpentries/public-survey-info/master/documents/reports/Carpentry-Reports/Long-Term-Feedback-Survey-Report/2017-04-17-carpentry-long-term-assessment-survey-data-public.csv", "2017-04-17-carpentry-long-term-assessment-survey-data-public.csv")

data <- read.csv("2017-04-17-carpentry-long-term-assessment-survey-data-public.csv", na.strings = "")
```
### Respondent Demographics
Provided below is a breakdown of our respondents by the Country where they attended a Carpentry workshop. A large portion of Carpentry learners responding to the survey attended a workshop in the United States. Additionally, a large number of our respondents are **Graduate Students**.

```{r}
table(data$Country)
```
```{r echo=FALSE}
data_country_tally <- 
  data %>%
  group_by(Country) %>% 
  tally() %>% 
  filter(!is.na(Country)) %>% 
  arrange(desc(n))

# #Use this plot to show all countries
ggplot(data_country_tally,
       aes(reorder(Country, n),
           n)) +
  geom_bar(stat = "identity", fill = "orange") +
  theme_classic() +
  xlab("") +
  ylab("") +
  coord_flip() +
  ggtitle("Carpentry Workshop Respondents by Country") +
  theme(plot.title = element_text(hjust = 0.5)) +
  theme_bw(base_size = 14)

# Thank you Naupaka for the tips on changing colors! 
# country_colors <- rep("orange", length(levels(data$Country)))
# country_colors[levels(data$Country) == "South Africa"] <- "blue"

# ggplot(data_country_tally, 
#       aes(reorder(Country, n), 
#           n)) + 
#  geom_bar(aes(fill = Country),
#           stat = "summary", 
#           fun.y = "mean") + 
#           theme_classic() +
#           xlab("") +
#           ylab("") +
#           coord_flip() +
#  ggtitle("Carpentry Workshop Respondents by Country") +
#  theme(plot.title = element_text(hjust = 0.5)) +
#  theme_bw(base_size = 14) +
#  scale_fill_manual(values = country_colors, guide = FALSE)
```

# Breakdown of Respondents by Position
```{r echo=FALSE}
position = c("Undergraduate Student", "Graduate Student", "Postdoc", "Faculty", "Industry", "Academic Research Staff", "Other Academic Staff", "Other (please specify)")
position = factor(position)

data$Position = factor(data$Position, levels = position)

data_position_tally <- 
  data %>% 
  group_by(Position) %>% 
  tally() %>% 
  filter(!is.na(Position)) 

kable(data_position_tally)

ggplot(data_position_tally, 
       aes(Position, n)) +
  geom_bar(stat = "identity", fill="orange") +
  scale_x_discrete(labels = function(x) lapply(strwrap(x, width = 10, simplify = FALSE), paste, collapse="\n")) +
  theme_classic() +
  xlab("") +
  ylab("") +
  ggtitle("Majority of Respondents are Graduate Students") +
  theme(plot.title = element_text(hjust = 0.5)) +
  theme_classic(base_size = 14)
```

```{r include=FALSE}
table(data$Position.Other)
```
## Number of Workshops Attended 
```{r}
#How do I change the label for this table?
data_workshops_tally <- 
  data %>% 
  group_by(How.Many.Workshops) %>% 
  tally() %>% 
  filter(!is.na(How.Many.Workshops)) 

kable(data_workshops_tally)
```

# How Long Ago Did Respondents Take a Workshop
```{r}

data_howlong_tally <- 
  data %>% 
  group_by(How.Long.Ago) %>% 
  tally() %>% 
  filter(!is.na(How.Long.Ago)) 

kable(data_howlong_tally)
```
# Tools Covered
```{r include=FALSE}
# These commands were used to get a count
# of the tools covered in the respondents workshop.
table(data$Content)
table(data$Column14)
table(data$Column15)
table(data$Column16)
table(data$Column17)
table(data$Column18)
table(data$Column19)
table(data$Column20)
table(data$Column21)
table(data$Column22)
```
```{r}
tools <- matrix(c(11,362,5,3,28,289,186,20,134,274),ncol=1,byrow=TRUE)
colnames(tools) <-("Tools Covered")
rownames(tools) <-c("Cloud Computing",
                        "Git",
                        "MATLAB",
                        "Mercurial",
                        "OpenRefine",
                        "Python",
                        "R",
                        "Spreadsheets",
                        "SQL",
                        "Unix Shell")

kable(tools)
```

# Programming Usage Pre-Carpentry Workshop
```{r echo=FALSE}
programming = c("I had not been using tools like these.", "Less than once per year.", "Several times per year.", "Monthly.", "Weekly.", "Daily.")
programming = factor(programming)

data$Programming.Usage.Before.Workshop = factor(data$Programming.Usage.Before.Workshop, levels = programming)

data_usage_tally <- 
  data %>% 
  group_by(Programming.Usage.Before.Workshop) %>% 
  tally() %>% 
  filter(!is.na(Programming.Usage.Before.Workshop)) 

#Change title
kable(data_usage_tally)

ggplot(data_usage_tally, 
       aes(Programming.Usage.Before.Workshop, n)) +
  geom_bar(stat = "identity", fill="orange") +
  scale_x_discrete(labels = function(x) lapply(strwrap(x, width = 10, simplify = FALSE), paste, collapse="\n")) +
  theme_classic() +
  xlab("") +
  ylab("") +
  ggtitle("Programming Usage Pre-Workshop Varies") +
  theme(plot.title = element_text(hjust = 0.5)) +
  theme_classic(base_size = 14)
```

# Programming Post-Carpentry Workshop
```{r echo=FALSE}
programming = c("I have not been using tools like these.", "Less than once per year.", "Several times per year.", "Monthly.", "Weekly.", "Daily.")
programming = factor(programming)

data$Programming.Usage.Since.Workshop = factor(data$Programming.Usage.Since.Workshop, levels = programming)

data_usage_tally <- 
  data %>% 
  group_by(Programming.Usage.Since.Workshop) %>% 
  tally() %>% 
  filter(!is.na(Programming.Usage.Since.Workshop)) 

#Change title
kable(data_usage_tally)

ggplot(data_usage_tally, 
       aes(Programming.Usage.Since.Workshop, n)) +
  geom_bar(stat = "identity", fill="orange") +
  scale_x_discrete(labels = function(x) lapply(strwrap(x, width = 10, simplify = FALSE), paste, collapse="\n")) +
  theme_classic() +
  xlab("") +
  ylab("") +
  ggtitle("Respondents' Programming Usage Increased") +
  theme(plot.title = element_text(hjust = 0.5)) +
  theme_classic(base_size = 14)
```

# Behaviors Adopted Post-Workshop
```{r include=FALSE}
# These commands were used to get a count
# of the behaviors adopted.
table(data$Behaviors.Adopted)
table(data$Column25)
table(data$Column26)
table(data$Column27)
table(data$Column28)
table(data$Column29)
table(data$Column30)
table(data$Column31)
table(data$Column32)
```

We asked respondents to identify the behaviors they adopted as a result of completing a Carpentry workshop. We are happy to report that more than half of the respondents who answered this question (n=395) have improved their data management and project organization practices, used programming languages for automation, and used version control to manage code.

```{r}
behaviors <- matrix(c(198,74,119,111,260,169,185,119,122),ncol=1,byrow=TRUE)
colnames(behaviors) <-("Behaviors Adopted")
rownames(behaviors) <-c("Improving data management and project organization.",
                        "Developing a data management and analysis plan.",
                        "Using databases, scripts and queries to manage large data sets.",
                        "Transforming step-by-step workflows into scripts or functions.",
                        "Using programming languages like R or Python, or the command line to automate repetitive tasks.",
                        "Reusing code.",
                        "Using version control to manage code.",
                        "Using version control to collaborate online (in public or private repositories).",
                        "Sharing code or data publicly on places like GitHub or FigShare.")

kable(behaviors)
```


# Change in Confidence Post-Carpentry Workshop
```{r}
data_confidence_tally <-
  data %>% 
  group_by(Change.In.Confidence) %>% 
  tally() %>% 
  filter(!is.na(Change.In.Confidence)) %>% 
  arrange(desc(n))
kable(data_confidence_tally)

data_change.in.confidence_tally <- 
  data %>% 
  group_by(Change.In.Confidence) %>% 
  tally() %>% 
  filter(!is.na(Change.In.Confidence)) %>% 
  arrange(desc(n))

ggplot(data_change.in.confidence_tally, 
       aes(reorder(Change.In.Confidence, n),
           n)) +
  geom_bar(stat = "identity", fill = "orange") +
   scale_x_discrete(labels = function(x) lapply(strwrap(x, width = 10, simplify = FALSE), paste, collapse="\n")) +
  theme_classic() +
  xlab("") +
  ylab("") +
  ggtitle("Respondents are More Confident Post-Workshop")+
  theme(plot.title = element_text(hjust = 0.5)) +
  theme_bw(base_size = 14)
```

# Usage of Tools for Research and/or Work
```{r include=FALSE}
table(data$How.Tools.Learned.Help)
table(data$Column34)
table(data$Column35)
table(data$Column36)
table(data$Column37)
```
```{r}
career <- matrix(c(245,217,203,28,61),ncol=1,byrow=TRUE)
colnames(career) <-("How Have the Tools Covered Helped Your Work?")

rownames(career) <-c("They are improving my overall efficiency.",
                        "They are improving my ability to analyze data.",
                        "They are improving my ability to manage data.",
                        "The tools I learned have not helped me with my work.",
                        "I am not using the tools I learned.")

kable(career)
```

# Have Tools Learned Contributed to Academic Writing?
```{r}
data_writing_tally <- 
  data %>% 
  group_by(Contributed.To.Writing) %>% 
  tally() %>% 
  filter(!is.na(Contributed.To.Writing)) %>% 
  arrange(desc(n))

kable(data_writing_tally)
```

# Involvement in the Carpentries Post-Workshop
```{r include=FALSE}
table(data$Carpentry.Involvement)
table(data$Column45)
table(data$Column46)
table(data$Column47)
table(data$Column48)
table(data$Column49)
table(data$Column50)
table(data$Column51)
```
```{r}
involvement <- matrix(c(120,18,31,26,6,12,11,18),ncol=1,byrow=TRUE)
colnames(involvement) <-("Involvement Since Attending a Carpentry Workshop")
rownames(involvement) <-c("Subscribed to the newsletter.",
                        "Attended at least one community call.",
                        "Became a workshop helper.",
                        "Became a Carpentry instructor.",
                        "Joined a committee.",
                        "Joined a mentoring group.",
                        "Participated in a Twitter chat.",
                        "Contributed to a Carpentry lesson.")
kable(involvement)

```

# Did Respondents Recommend Carpentry Workshops?
```{r}
data_recommended_tally <-
  data %>% 
  group_by(Recommended) %>% 
  tally() %>% 
  filter(!is.na(Recommended)) %>% 
  arrange(desc(n))

kable(data_recommended_tally)
```

# Learner Perception of Workshop Atmosphere
Using the [Likert](http://jason.bryer.org/likert/) package, the following chart is an analysis of learner responses to the statements above.

```{r echo=TRUE}
cols_with_Agree <- map_lgl(data, ~`%in%`("Agree", .x))
data_agree <-  data[ , cols_with_Agree]

order = c("Strongly Disagree", "Disagree", "Neither Agree nor Disagree", "Agree", "Strongly Agree")

# How do I get the [1] data.frame not to show on the output? 
print(class(data_agree))
data_agree <- map_if(data_agree,
                     is.character,
                     as.factor)

# Thanks Elizabeth for the tip!
for(i in seq_along(data_agree)) {
                data_agree[[i]] <- factor(data_agree[[i]], levels=order)
}

print(levels(data_agree))
title <- "Workshops are Welcoming & Useful"
data_agree_likert <-  likert(as.data.frame(data_agree)) 
theme_update(plot.title = element_text(hjust = 0.5))

plot(data_agree_likert) + ggtitle(title)
```
```{r echo=FALSE}
table(data$Which.of.the.following.learning.activities.for.data.management.and.analysis)
table(data$Column45)
table(data$Column46)
table(data$Column47)
table(data$Column48)
table(data$Column49)
table(data$Column50)
table(data$Column51)








```
```{r}
# In what country did you attend a Carpentry workshop? 
#map <- get_map(location = 'Europe', zoom = 4)
#ggmap(map)
```
